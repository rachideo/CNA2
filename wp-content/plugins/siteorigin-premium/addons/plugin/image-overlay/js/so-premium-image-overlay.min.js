window.SiteOriginPremium=window.SiteOriginPremium||{},SiteOriginPremium.ImageOverlay=function(i,t){var h=jQuery;this.image=i,this.options=t,this.init=function(){this.imageContainer=h(i).parent().closest(":not( a )"),this.createChildren(),this.addEventListeners(),setTimeout(this.layoutChildren.bind(this),150)},this.createChildren=function(){this.canHover=window.matchMedia("(hover:hover)").matches,this.overlayContainer=h('<div class="so-premium-image-overlay-container"></div>'),this.overlay=h('<div class="so-premium-image-overlay"></div>'),this.overlayBackground=h('<div class="so-premium-image-overlay-background"></div>'),this.overlayBackground.css({backgroundColor:t.overlay_color,opacity:t.overlay_opacity}),this.overlay.append(this.overlayBackground),this.overlayText=h('<div class="so-premium-image-overlay-text">'+this.image.title+"</div>"),h(this.image).css("pointerEvents","none");var i={margin:"0",padding:this.options.text_padding};t.hasOwnProperty("font")&&t.font&&(i.fontFamily=t.font.family,t.font.hasOwnProperty("weight")&&(i.fontWeight=t.font.weight),t.font.hasOwnProperty("url")&&h("head").append('<link rel="stylesheet" media="all" href="'+t.font.url+'"/>')),t.hasOwnProperty("text_size")&&(i.fontSize=t.text_size),t.hasOwnProperty("text_color")&&(i.color=t.text_color),i.textAlign=t.text_align,this.overlayText.css(i),this.overlay.append(this.overlayText),this.overlay.css("opacity",0),this.overlayContainer.append(this.overlay),this.overlayContainer.css({overflow:"hidden"}),this.imageContainer.append(this.overlayContainer)},this.layoutChildren=function(){var i=h(this.image),t=this.imageContainer.position();t.width=Math.min(this.imageContainer.width(),i.width()),t.height=Math.min(this.imageContainer.height(),i.height());var e={top:Math.max(0,i.position().top),left:Math.max(0,i.position().left),width:t.width,height:t.height,maxWidth:this.imageContainer.css("maxWidth"),maxHeight:this.imageContainer.css("maxHeight")};this.overlayContainer.css(e);var a={top:0,left:0,width:t.width,height:t.height,maxWidth:i.css("maxWidth"),maxHeight:i.css("maxHeight")},n=this.options.overlay_size;switch(this.options.overlay_position){case"top":a.height=t.height*n;break;case"right":a.width=t.width*n,a.left=t.width-a.width;break;case"bottom":a.height=t.height*n,a.top=t.height-a.height;break;case"left":a.width=t.width*n}this.overlay.css(a);var o=this.overlay.outerHeight(),s=this.overlayText.outerHeight(),r={};switch(this.options.text_position){case"top":r.top=0;break;case"middle":r.top=.5*(o-s);break;case"bottom":r.top=o-s}this.overlayText.css(r),this.canHover||"always"!==this.options.touch_show_trigger?(this.options.overlay_animation&&"none"!==this.options.overlay_animation&&(this.animationTimeline=anime.timeline({autoplay:!1}),this.animationTimeline.add(this.getAnimationOptions(this.overlay.get(0),this.options.overlay_animation,{position:this.options.overlay_position}))),this.options.text_animation&&"none"!==this.options.text_animation&&(this.animationTimeline||(this.animationTimeline=anime.timeline({autoplay:!1})),this.animationTimeline.add(this.getAnimationOptions(this.overlayText.get(0),this.options.text_animation)))):this.overlay.css("opacity",1)},this.getAnimationOptions=function(i,t,e){var a={targets:i,changeBegin:function(){this.overlayContainer.css("overflow","hidden")}.bind(this)},n=h(i);switch(t){case"fade":a.easing="linear",a.duration=250,a.opacity=[0,1];break;case"slide":switch(a.easing="easeOutExpo",a.duration=500,n.css("opacity",1),e.hasOwnProperty("position")?e.position:"top"){case"top":a.translateY=[-n.outerHeight(),0];break;case"right":a.translateX=[n.parent().outerWidth(),0];break;case"bottom":a.translateY=[n.parent().outerHeight(),0];break;case"left":a.translateX=[-n.outerWidth(),0]}break;case"slide_left":a.easing="easeOutExpo",a.duration=500,a.opacity=[0,1],a.translateX=[20,0];break;case"slide_right":a.easing="easeOutExpo",a.duration=500,a.opacity=[0,1],a.translateX=[-20,0];break;case"slide_up":a.easing="easeOutExpo",a.duration=500,a.opacity=[0,1],a.translateY=[10,0];break;case"slide_down":a.easing="easeOutExpo",a.duration=500,a.opacity=[0,1],a.translateY=[-10,0];break;case"drop":a.easing="linear",a.duration=250,a.opacity=[0,1],a.scale=[1.1,1],a.changeBegin=function(){this.overlayContainer.css("overflow","visible")}.bind(this)}return a},this.addEventListeners=function(){this.imageContainer.is(".sow-masonry-grid-item,.sow-image-grid-image")&&this.imageContainer.closest(".sow-masonry-grid,.sow-image-grid-wrapper").on("layoutComplete",this.layoutChildren.bind(this)),h(window).on("resize",this.layoutChildren.bind(this)),this.canHover?(this.imageContainer.on("mouseenter",function(){this.showOverlay()}.bind(this)),this.imageContainer.on("mouseleave",function(){this.hideOverlay()}.bind(this))):"touch"===this.options.touch_show_trigger&&this.imageContainer.on("touchend",function(){this.toggleOverlay()}.bind(this))},this.showOverlay=function(){this.showingOverlay||(this.showingOverlay=!0,this.animationTimeline?("reverse"===this.animationTimeline.direction&&this.animationTimeline.reverse(),this.animationTimeline.began&&!this.animationTimeline.completed||this.animationTimeline.play()):this.overlay.css("opacity",1))},this.hideOverlay=function(){this.showingOverlay&&(this.showingOverlay=!1,this.animationTimeline?("normal"===this.animationTimeline.direction&&this.animationTimeline.reverse(),this.animationTimeline.completed&&(this.animationTimeline.completed=!1,this.animationTimeline.play())):this.overlay.css("opacity",0))},this.toggleOverlay=function(){if(this.animationTimeline)this.animationTimeline.began&&"normal"===this.animationTimeline.direction?this.hideOverlay():this.showOverlay();else{var i=1===this.overlay.css("opacity")?0:1;this.overlay.css("opacity",i)}},i.complete?this.init():(i.addEventListener("load",function(){this.init()}.bind(this)),i.addEventListener("error",function(){console.log("Could not setup Image Overlay. Image loading failed.")}))},SiteOriginPremium.createImageOverlays=function(n){n(".so-widget-sow-image, .so-widget-sow-image-grid, .so-widget-sow-simple-masonry").each(function(i,t){var e=n(t);if(e.data("overlay-enabled")){var a=e.data("overlay-settings");n(t).find("img").each(function(i,t){t.title&&(t.classList.contains("jetpack-lazy-image")?n(t).on("jetpack-lazy-loaded-image",function(i){new SiteOriginPremium.ImageOverlay(i.target,a)}):new SiteOriginPremium.ImageOverlay(t,a))})}})},jQuery(function(i){SiteOriginPremium.createImageOverlays(i),window.sowb&&i(window.sowb).on("setup_widgets",function(){SiteOriginPremium.createImageOverlays(i)})});